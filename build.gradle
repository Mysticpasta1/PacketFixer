//file:noinspection GroovyAssignabilityCheck
//file:noinspection GrDeprecatedAPIUsage
println('Java: ' + System.getProperty('java.version') + ' JVM: ' + System.getProperty('java.vm.version') + '(' + System.getProperty('java.vendor') + ') Arch: ' + System.getProperty('os.arch'))

allprojects {
    apply plugin: 'maven-publish'
    apply plugin: 'eclipse'
}

subprojects {
    apply plugin: 'net.minecraftforge.gradle'
    apply plugin: 'org.parchmentmc.librarian.forgegradle'
    apply plugin: 'org.spongepowered.mixin'

    group = 'PacketSizeDoublerForge'
    version = "1.0.8-${version}"
    archivesBaseName = 'PacketSizeDoublerForge'

    mixin {
        config "packetsizedoublerforge.mixins.json"
        add sourceSets.main, "packetsizedoublerforge.refmap.json"
        disableEclipseAddon = true
        debug.export = true
    }

    dependencies {
        annotationProcessor "org.spongepowered:mixin:0.8.5:processor"
    }

    sourceSets.main.resources { srcDir 'src/generated/resources' }

    jar {
        destinationDir = file("$rootDir/artifacts")

        manifest {
            attributes([
                    "Specification-Title"     : "PacketSizeDoublerForge",
                    "Specification-Vendor"    : "TonimatasDEV",
                    "Specification-Version"   : "1",
                    "Implementation-Title"    : project.name,
                    "Implementation-Version"  : project.jar.archiveVersion,
                    "Implementation-Vendor"   : "TonimatasDEV",
                    "Implementation-Timestamp": new Date().format("yyyy-MM-dd'T'HH:mm:ssZ")
            ])
        }
    }
}

tasks.register('exportAll') {
    dependsOn '1-15-x:jar', '1-16-x:jar', '1-17-x:jar', '1-18-x:jar', '1-19-x:jar'
}